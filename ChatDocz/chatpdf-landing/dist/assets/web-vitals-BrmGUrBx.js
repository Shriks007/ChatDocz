var q=Object.defineProperty;var H=(e,t,n)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var h=(e,t,n)=>H(e,typeof t!="symbol"?t+"":t,n);let B=-1;const p=e=>{addEventListener("pageshow",t=>{t.persisted&&(B=t.timeStamp,e(t))},!0)},l=(e,t,n,r)=>{let i,a;return o=>{t.value>=0&&(o||r)&&(a=t.value-(i??0),(a||i===void 0)&&(i=t.value,t.delta=a,t.rating=((s,c)=>s>c[1]?"poor":s>c[0]?"needs-improvement":"good")(t.value,n),e(t)))}},y=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},C=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},v=()=>{const e=C();return(e==null?void 0:e.activationStart)??0},u=(e,t=-1)=>{const n=C();let r="navigate";return B>=0?r="back-forward-cache":n&&(document.prerendering||v()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},f=new WeakMap;function M(e,t){return f.get(e)||f.set(e,new t),f.get(e)}class D{constructor(){h(this,"t");h(this,"i",0);h(this,"o",[])}h(t){var i;if(t.hadRecentInput)return;const n=this.o[0],r=this.o.at(-1);this.i&&n&&r&&t.startTime-r.startTime<1e3&&t.startTime-n.startTime<5e3?(this.i+=t.value,this.o.push(t)):(this.i=t.value,this.o=[t]),(i=this.t)==null||i.call(this,t)}}const b=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver(i=>{Promise.resolve().then(()=>{t(i.getEntries())})});return r.observe({type:e,buffered:!0,...n}),r}}catch{}},L=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let m=-1;const E=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,g=e=>{document.visibilityState==="hidden"&&m>-1&&(m=e.type==="visibilitychange"?e.timeStamp:0,O())},P=()=>{addEventListener("visibilitychange",g,!0),addEventListener("prerenderingchange",g,!0)},O=()=>{removeEventListener("visibilitychange",g,!0),removeEventListener("prerenderingchange",g,!0)},x=()=>{var e;if(m<0){const t=v();m=(document.prerendering||(e=globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>t)[0])==null?void 0:e.startTime)??E(),P(),p(()=>{setTimeout(()=>{m=E(),P()})})}return{get firstHiddenTime(){return m}}},S=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},w=[1800,3e3],R=(e,t={})=>{S(()=>{const n=x();let r,i=u("FCP");const a=b("paint",o=>{for(const s of o)s.name==="first-contentful-paint"&&(a.disconnect(),s.startTime<n.firstHiddenTime&&(i.value=Math.max(s.startTime-v(),0),i.entries.push(s),r(!0)))});a&&(r=l(e,i,w,t.reportAllChanges),p(o=>{i=u("FCP"),r=l(e,i,w,t.reportAllChanges),y(()=>{i.value=performance.now()-o.timeStamp,r(!0)})}))})},A=[.1,.25],_=(e,t={})=>{R(L(()=>{let n,r=u("CLS",0);const i=M(t,D),a=s=>{for(const c of s)i.h(c);i.i>r.value&&(r.value=i.i,r.entries=i.o,n())},o=b("layout-shift",a);o&&(n=l(e,r,A,t.reportAllChanges),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(a(o.takeRecords()),n(!0))}),p(()=>{i.i=0,r=u("CLS",0),n=l(e,r,A,t.reportAllChanges),y(()=>n())}),setTimeout(n))}))},$=e=>{const t=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?e():(e=L(e),document.addEventListener("visibilitychange",e,{once:!0}),t(()=>{e(),document.removeEventListener("visibilitychange",e)}))};class I{constructor(){h(this,"m")}h(t){var n;(n=this.m)==null||n.call(this,t)}}const F=[2500,4e3],j=(e,t={})=>{S(()=>{const n=x();let r,i=u("LCP");const a=M(t,I),o=c=>{t.reportAllChanges||(c=c.slice(-1));for(const d of c)a.h(d),d.startTime<n.firstHiddenTime&&(i.value=Math.max(d.startTime-v(),0),i.entries=[d],r())},s=b("largest-contentful-paint",o);if(s){r=l(e,i,F,t.reportAllChanges);const c=L(()=>{o(s.takeRecords()),s.disconnect(),r(!0)});for(const d of["keydown","click","visibilitychange"])addEventListener(d,()=>$(c),{capture:!0,once:!0});p(d=>{i=u("LCP"),r=l(e,i,F,t.reportAllChanges),y(()=>{i.value=performance.now()-d.timeStamp,r(!0)})})}})},k=[800,1800],T=e=>{document.prerendering?S(()=>T(e)):document.readyState!=="complete"?addEventListener("load",()=>T(e),!0):setTimeout(e)},z=(e,t={})=>{let n=u("TTFB"),r=l(e,n,k,t.reportAllChanges);T(()=>{const i=C();i&&(n.value=Math.max(i.responseStart-v(),0),n.entries=[i],r(!0),p(()=>{n=u("TTFB",0),r=l(e,n,k,t.reportAllChanges),r(!0)}))})};export{A as CLSThresholds,w as FCPThresholds,F as LCPThresholds,k as TTFBThresholds,_ as onCLS,R as onFCP,j as onLCP,z as onTTFB};
